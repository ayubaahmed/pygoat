{% extends 'base.html' %}

{% block title %} Using Components with Known Vulnerabilities {% endblock %}

{% block content %}
<div class="content">
    <div class="header-container">
        <h1 style="border-bottom: 2px solid #474646; padding-bottom: 10px;">Using Components with Know Vulnerability</h1>
        <button class="notebook-btn" onclick="openModal()" title="View Secure Implementation">
        ðŸ”—
        </button>
    </div>
    {% include 'secure-fix.html' %}
    
    <div class="box">
        <h3>What does Using Components with Know Vulnerability means?</h3>
        <p>When a developer uses a piece of code or library which already has a known vulnerability, then
           this may result in compromise of the entire application. This occurs when the components such as libraries
           and frameworks used within the app mostly execute with full privileges. If a vulnerable component is
           exploited, it makes the hacker's job easier to cause a serious data loss or server takeover.</p>
    </div>

    <div class="box">
        <h3>Available Labs</h3>
        
        <div class="lab-grid">
            <div class="lab-card">
                <div class="lab-card-content">
                    <h3>Lab 1: YAML Parsing Vulnerability</h3>
                    <p>Explore vulnerabilities in outdated YAML parsing libraries that can lead to remote code execution.</p>
                </div>
                <a href="{{ url_for('lab1') }}" class="btn">Access Lab 1</a>
            </div>

            <div class="lab-card">
                <div class="lab-card-content">
                    <h3>Lab 2: Image Processing Vulnerability</h3>
                    <p>Learn about security issues in outdated image processing libraries that can be exploited.</p>
                </div>
                <a href="{{ url_for('lab2') }}" class="btn">Access Lab 2</a>
            </div>
        </div>
    </div>

    <div class="box">
        <h3>Mitigation Steps</h3>
        <div class="lab-section">
            <ul>
                <li>Remove unused dependencies, unnecessary features, components, files, and documentation.</li>
                <li>Only obtain components from official sources over secure links.</li>
                <li>Monitor for libraries and components that are unmaintained or do not create security patches for older versions.</li>
                <li>Use Library scanners to test for vulnerabilities in packages.</li>
            </ul>
        </div>
    </div>
</div>
<script>
        // Modal functionality
function openModal() {
    document.getElementById('secureFixModal').style.display = 'block';
    document.body.style.overflow = 'hidden'; 
}

function closeModal() {
    document.getElementById('secureFixModal').style.display = 'none';
    document.body.style.overflow = 'auto'; 
}
function showTab(tabName) {
    const panels = document.querySelectorAll('.tab-panel');
    panels.forEach(panel => panel.classList.remove('active'));
    
    const buttons = document.querySelectorAll('.tab-btn');
    buttons.forEach(btn => btn.classList.remove('active'));
    
    document.getElementById(tabName).classList.add('active');
    
    event.target.classList.add('active');
}

document.addEventListener('click', function(event) {
    const modal = document.getElementById('secureFixModal');
    const overlay = event.target.classList.contains('modal-overlay');
    if (overlay) {
        closeModal();
    }
});

document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeModal();
    }
});
</script>
{% endblock %}
